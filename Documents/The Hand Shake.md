
# The Hand Shake

The client opens a connection to a server where the server is listening on a port that supports TLS.

This is the initiation of the Hand Shake.

The Hand Shake is done in several steps whereby the client and server must be able to agree on several aspects to the setup
of a secure connection. Which means that upon verification of the server (or mutual verification), they will agree to use
shared symmetric keys with which to encrypt all subsequent messages between them.

## Major goals of the Hand Shake:
- Cipher suite negotiation
- Client Authentication of the server - prevents Man-in-the-Middle attacks. Optionally, the server authenticates the client : asymetric keys
- Gemeration of the Session key information exchange : symetric keys

## What attributes must they agree upon?

### 1. TLS Protocol Version
a. Recommended version: 1.2 or 1.1
b. Note that 1.0 is NOT recommended, nor the earlier SSL versions such as SSLv3

### 2. Cipher Suite
ex: AES-128 with SHA

A cipher suite contains an algorithm for each of the following:
* key exchange
* authentication
* data encryption
* message authentication = MAC algorithm

### 3. Pre-master secret: generated by the client
A 46-byte random number used in the generation of the symmetric encryption keys and the message authentication code (MAC) keys
used to create master secret and session keys

### 4. Master secret: server and client each generate the Master Secret and session keys based on the Pre-Master Secret
48 byte secret created from the pre-master secret

Used to create session keys: create the MAC and encrypt keys
- client write MAC key : used for authentication and integrity check
- server write MAC key : used for authentication and integrity check
- client write key : used for message encryption
- server write key : used for message encryption

## What messages are exchanged?

### 1. Client sends: tls version, supported cipher suites(prioritized by the client), data compression methods, 28 byte random number


### n. Change cipher spec: message client sends to the server
client will start using the new session keys for hashing and encrypting messages
client and server now start using the session keys to exchange all messages




